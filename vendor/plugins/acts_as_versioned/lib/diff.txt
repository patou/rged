199c199
<           self.non_versioned_columns        = [self.primary_key, inheritance_column, version_column, 'lock_version', versioned_inheritance_column]
---
>           self.non_versioned_columns        = [self.primary_key, inheritance_column, 'version', 'lock_version', versioned_inheritance_column]
201,205c201,205
<             :class_name  => "#{self.to_s}::#{versioned_class_name}",
<             :foreign_key => "#{versioned_foreign_key}",
<             :order       => "#{version_column}",
<             :dependent   => :delete_all
<           }.merge(options[:association_options] || {})
---
>                                                 :class_name  => "#{self.to_s}::#{versioned_class_name}",
>                                                 :foreign_key => versioned_foreign_key,
>                                                 :order       => 'version',
>                                                 :dependent   => :delete_all
>                                               }.merge(options[:association_options] || {})
253,254c253,254
<             :conditions => ["#{original_class.versioned_foreign_key} = ? and  #{original_class.version_column} < ?", version.send(original_class.versioned_foreign_key), version.version] #FIXME
<               end
---
>                 :conditions => ["#{original_class.versioned_foreign_key} = ? and version < ?", version.send(original_class.versioned_foreign_key), version.version]
>             end
259c259
<                 :conditions => ["#{original_class.versioned_foreign_key} = ? and #{original_class.version_column} > ?", version.send(original_class.versioned_foreign_key), version.version] #FIXME
---
>                 :conditions => ["#{original_class.versioned_foreign_key} = ? and version > ?", version.send(original_class.versioned_foreign_key), version.version]
296c296
<           rev.send("#{self.class.version_column}=", send(self.class.version_column))
---
>           rev.version = send(self.class.version_column)
307c307
<             sql = "DELETE FROM #{self.class.versioned_table_name} WHERE #{self.class.version_column} <= #{excess_baggage} AND #{self.class.versioned_foreign_key} = #{self.id}"
---
>             sql = "DELETE FROM #{self.class.versioned_table_name} WHERE version <= #{excess_baggage} AND #{self.class.versioned_foreign_key} = #{self.id}"
424c424
<             (versions.calculate(:max, self.version_column.to_sym) || 0) + 1
---
>             (versions.calculate(:max, :version) || 0) + 1
443c443
<               :conditions => ["#{versioned_foreign_key} = ? AND  #{version_column} = ?", id, version],
---
>               :conditions => ["#{versioned_foreign_key} = ? AND version = ?", id, version],
451c451
<               :order      =>  "#{version_column}" }.merge(options)
---
>               :order      => 'version' }.merge(options)
468c468
<               self.connection.add_column table_name,  version_column, :integer
---
>               self.connection.add_column table_name, :version, :integer
473c473
<               t.column version_column, :integer
---
>               t.column :version, :integer
498d497
< #            self.connection.remove_column table_name, version_column# FIXME
